(()=>{"use strict";const t=function(){function t(){var t=this;localStorage.getItem("todos")?this.todos=JSON.parse(localStorage.getItem("todos")):this.todos=[],window.addEventListener("beforeunload",(function(){localStorage.setItem("todos",JSON.stringify(t.todos))}))}return t.prototype.addTodo=function(t){var o={id:this.todos.length>0?this.todos[this.todos.length-1].id+1:1,text:t,complete:!1};this.todos.push(o),this.onTodoListChanged(this.todos)},t.prototype.edidTodo=function(t,o){this.todos=this.todos.map((function(e){return e.id===t?{id:e.id,text:o,complete:e.complete}:e})),this.onTodoListChanged(this.todos)},t.prototype.deleteTodo=function(t){this.todos=this.todos.filter((function(o){return o.id!==t})),this.onTodoListChanged(this.todos)},t.prototype.toggleTodo=function(t){this.todos=this.todos.map((function(o){return o.id===t?{id:o.id,text:o.text,complete:!o.complete}:o})),this.onTodoListChanged(this.todos)},t.prototype.bindTodoListChanged=function(t){this.onTodoListChanged=t},t}();var o=function(t,o){void 0===t&&(t="div");var e=document.createElement(t);return o&&e.classList.add(o),e};const e=function(){function t(){var t;this.app=(t="body",document.querySelector(t)?document.querySelector(t):void 0),this.title=o("h1"),this.title.textContent="Todos",this.form=o("form"),this.input=document.createElement("input"),this.input.type="text",this.input.placeholder="Add todo",this.input.name="todo",this.submitButton=o("button"),this.submitButton.textContent="Submit",this.todoList=o("ul","todo-list"),this.form.append(this.input,this.submitButton),this.app.append(this.title,this.form,this.todoList),this.initLocalListeners()}return Object.defineProperty(t.prototype,"todoText",{get:function(){return this.input.value},enumerable:!1,configurable:!0}),t.prototype.resetInput=function(){this.input.value=""},t.prototype.initLocalListeners=function(){var t=this;this.todoList.addEventListener("input",(function(o){var e=o.target;"editable"===e.className&&(t.temporaryTodoText=e.innerText)}))},t.prototype.render=function(t){for(var e=this;this.todoList.firstChild;)this.todoList.removeChild(this.todoList.firstChild);if(0===t.length){var i=o("p");i.textContent="Nothing to do! Add a new task?",this.todoList.append(i)}else t.forEach((function(t){var i=o("li");i.id=t.id.toString();var n=o("input");n.type="checkbox",n.checked=t.complete;var d=o("span");d.contentEditable="true",d.classList.add("editable"),d.textContent=t.text,t.complete&&d.classList.add("stike");var s=o("button","delete");s.textContent="Delete",i.append(n,d,s),e.todoList.append(i)}))},t.prototype.bindAddTodo=function(t){var o=this;this.form.addEventListener("submit",(function(e){e.preventDefault(),o.todoText&&(t(o.todoText),o.resetInput())}))},t.prototype.bindDeleteTodo=function(t){this.todoList.addEventListener("click",(function(o){var e=o.target;if("delete"===e.className&&e.parentElement){var i=parseInt(e.parentElement.id);t(i)}}))},t.prototype.bindToggleTodo=function(t){this.todoList.addEventListener("change",(function(o){var e=o.target;if("checkbox"===e.type&&e.parentElement){var i=parseInt(e.parentElement.id);t(i)}}))},t.prototype.bindEditTodo=function(t){var o=this;this.todoList.addEventListener("focusout",(function(e){var i=e.target;if(o.temporaryTodoText){var n=parseInt(i.parentElement.id);t(n,o.temporaryTodoText),o.temporaryTodoText=""}}))},t}();new function(t,o){var e=this;this.start=function(){e.view.render(e.model.todos)},this.onTodoListChanged=function(t){e.view.render(t)},this.handleAddTodo=function(t){e.model.addTodo(t)},this.handleEditTodo=function(t,o){e.model.edidTodo(t,o)},this.handleDeleteTodo=function(t){e.model.deleteTodo(t)},this.handleToggleTodo=function(t){e.model.toggleTodo(t)},this.model=t,this.view=o,this.model.bindTodoListChanged(this.onTodoListChanged),this.view.bindAddTodo(this.handleAddTodo),this.view.bindEditTodo(this.handleEditTodo),this.view.bindDeleteTodo(this.handleDeleteTodo),this.view.bindToggleTodo(this.handleToggleTodo),this.onTodoListChanged(this.model.todos)}(new t,new e).start()})();